<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Test - Notes</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="../../style.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Notes</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="3"><a href="#inverted-page-table" class="nav-link">Inverted Page Table</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="3"><a href="#page-replacement-algorithms" class="nav-link">Page Replacement Algorithms</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#optimal-page-replacement-opt" class="nav-link">Optimal Page Replacement (OPT)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#fifo-page-replacement-algorithm" class="nav-link">FIFO Page Replacement Algorithm</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#least-recently-used-lru" class="nav-link">Least Recently Used (LRU)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#second-chance-page-replacement-aka-clock" class="nav-link">Second-Chance Page Replacement (aka CLOCK)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="3"><a href="#frame-allocation" class="nav-link">Frame Allocation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#file-management" class="nav-link">File Management</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="3"><a href="#file-protection" class="nav-link">File Protection</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#file-data" class="nav-link">File Data</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#file-information" class="nav-link">File Information</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#processes-and-files" class="nav-link">Processes and Files</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#directory" class="nav-link">Directory</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="3"><a href="#file-system-implementations" class="nav-link">File System Implementations</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="4"><a href="#file-block-allocation" class="nav-link">File Block Allocation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#free-space-management" class="nav-link">Free Space Management</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="4"><a href="#implementing-directory" class="nav-link">Implementing Directory</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h3 id="inverted-page-table">Inverted Page Table</h3>
<ul>
<li>Page table is a per-process information<ul>
<li>With M processes in memory, there are M independent page tables</li>
</ul>
</li>
<li>Observation:<ul>
<li>Only N physical memory frames can be occupied</li>
<li>Out of the M page tables, only N entries are valid!</li>
<li>Huge waste: N &lt;&lt; Overhead of M page tables</li>
</ul>
</li>
<li>Idea:<ul>
<li>Keep a single mapping of physical frame to <code>&lt;pid, page#&gt;</code></li>
<li>pid = process id , page# = logical page number in the corresponding the process</li>
<li>page# is not unique among processes</li>
<li>pid + page# can uniquely identify a memory page</li>
</ul>
</li>
<li><img alt="invertedPageTable" src="../invertedPageTable.png" /></li>
<li>Entries are ordered by frame number instead of page number</li>
</ul>
<h3 id="page-replacement-algorithms">Page Replacement Algorithms</h3>
<ul>
<li>No free physical memory frame during a page fault</li>
<li>Memory access time: T access = (1 - p) _ T mem + P _ T page fault<ul>
<li>p = probability of page fault</li>
<li>T mem = access time for memory resident page</li>
<li>T page fault = access time if page fault occurs</li>
</ul>
</li>
</ul>
<h4 id="optimal-page-replacement-opt">Optimal Page Replacement (OPT)</h4>
<ul>
<li>Replace the page that will not be needed again for the longest period of time</li>
<li>Guarantees minimum number of page fault</li>
<li>But future knowledge of memory references is needed</li>
</ul>
<h4 id="fifo-page-replacement-algorithm">FIFO Page Replacement Algorithm</h4>
<ul>
<li>Memory pages are evicted based on their loading time</li>
<li>Evict the oldest memory page</li>
<li>OS maintains a queue of resident page numbers</li>
<li>But FIFO does not exploit temporal locality</li>
</ul>
<h4 id="least-recently-used-lru">Least Recently Used (LRU)</h4>
<ul>
<li>Make used of temporal locality</li>
<li>Replace the page that has not been used in the longest time</li>
<li>But implementation is difficult<ul>
<li>Using a "time" counter: need to search through all pages to find the smallest</li>
<li>Using a "stack": hard to implement in hardware because it is not a pure stack</li>
</ul>
</li>
</ul>
<h4 id="second-chance-page-replacement-aka-clock">Second-Chance Page Replacement (aka CLOCK)</h4>
<ul>
<li>Modified FIFO to give a second chance to pages that are accessed</li>
<li>Each page table entry has a reference bit</li>
<li>Degenerate into FIFO algorithm</li>
</ul>
<p>Algorithm:</p>
<ol>
<li>The oldest FIFO page is selected (victim page)</li>
<li>If reference bit == 0, page is replaced</li>
<li>If reference bit == 1, page is skipped and reference is cleared to 0</li>
</ol>
<h3 id="frame-allocation">Frame Allocation</h3>
<ul>
<li>Best way to distribute N physical memory frames to M processes competing for frames</li>
<li>Equal allocation<ul>
<li>Each process gets N/M frames</li>
</ul>
</li>
<li>Proportional allocation<ul>
<li>Each process gets size_of_process / total_size * N frames</li>
</ul>
</li>
<li>Victim page selected among pages of the process that causes page fault: local replacement<ul>
<li>Number of frames allocated to a process remain constant</li>
<li>If frames allocated not enough, it may hinder the progress of process</li>
</ul>
</li>
<li>Victim page selected among all physical frames: global replacement<ul>
<li>Allow self-adjustment between processes</li>
<li>Badly behaved processes can steal frames from other processes</li>
</ul>
</li>
<li>Thrashing<ul>
<li>Insufficient physical frame</li>
<li>In global replacement: A thrashing process "steals" page from other process cause other process to thrash (Cascading Thrashing)</li>
<li>In local replacement: thrashing can be limited to one process, but that process can use up the I/O bandwidth and degrade performance of others\</li>
</ul>
</li>
<li>Right number of frames: working set<ul>
<li>Transient region: working set changing in size</li>
<li>Stable region: working set about the same for a long time</li>
</ul>
</li>
</ul>
<h2 id="file-management">File Management</h2>
<ul>
<li><img alt="fileMetadata" src="../fileMetadata.png" /></li>
<li>Common file types:<ul>
<li>regular files: contains user information</li>
<li>Directories: system files for file system structure</li>
<li>Special files: character/ block oriented</li>
</ul>
</li>
<li>File types:<ul>
<li>Use file extension as indication</li>
<li>Use embedded information in the file (magic number stored at beginning of file)</li>
</ul>
</li>
</ul>
<h3 id="file-protection">File Protection</h3>
<ul>
<li>Controlled access to the information stored in a file</li>
<li>Access: read, write, execute, append, delete, list</li>
<li>Users classified into three classes:<ul>
<li>Owner</li>
<li>Group</li>
<li>Universe</li>
</ul>
</li>
<li>Define permission of three access types: r w x r w x r w x</li>
<li>Access control list can be<ul>
<li>Minimal (same as ppermission bits)</li>
<li>Extended (added named users/ groups)</li>
</ul>
</li>
</ul>
<h3 id="file-data">File Data</h3>
<ul>
<li>Structure<ul>
<li>Array of byes<ul>
<li>Each byte has a unique offset from file start</li>
</ul>
</li>
<li>Fixed length records<ul>
<li>Array of records that can grow and shrink</li>
</ul>
</li>
<li>Variable length records<ul>
<li>Flexible but harder to locate</li>
</ul>
</li>
</ul>
</li>
<li>Access methods<ul>
<li>Sequential access<ul>
<li>Data read in order, starting from beginning</li>
<li>e.g. cassette tapes</li>
</ul>
</li>
<li>Random access<ul>
<li>Data can be read in any order</li>
<li>Read (offset): every read operation explicitly states the position to be accessed</li>
<li>Seek (offset): special operation to move to a new location in file</li>
</ul>
</li>
<li>Direct access<ul>
<li>Used for file that contains fixed-length records</li>
<li>Allow random access to any record directly</li>
</ul>
</li>
</ul>
</li>
<li><img alt="fileDataGenericOperations" src="../fileDataGenericOperations.png" /></li>
<li>OS provides file operations as system calls<ul>
<li>Provide proection, concurrent and efficient access</li>
</ul>
</li>
<li><img alt="fileOperationsSystemCalls" src="../fileOperationsSystemCalls.png" /></li>
</ul>
<h3 id="file-information">File Information</h3>
<ul>
<li>Information kept for an opened file<ul>
<li>File pointer: keep track of the current position within a file</li>
<li>File descriptor: unique identifier of the file</li>
<li>Disk location: actual file location on disk</li>
<li>Open count/ reference count: number of proccesses that have the file opened</li>
</ul>
</li>
<li><img alt="fileOperations" src="../fileOperations.png" /></li>
<li>Per-process open-file table:<ul>
<li>To keep track of the open files for a process</li>
<li>Each entry points to the system-wide open-file table entries</li>
</ul>
</li>
<li>System-wide open-file table:<ul>
<li>To keep track of all the open files in the system</li>
<li>Each entry points to a V-node entry</li>
</ul>
</li>
<li>System-wide V-node (virtual node) table<ul>
<li>To link with the file on physical drive</li>
<li>Contains the information about the physical location of the file</li>
</ul>
</li>
</ul>
<h4 id="processes-and-files">Processes and Files</h4>
<ul>
<li>Process A tries to open a file that is currently being written by Process B.<ul>
<li>OS uses the Open File Table to check for existing opened file.</li>
<li>Since the file is already opened for reading, it can reject the file open system call from process A.</li>
</ul>
</li>
<li>Process A tries to use a bogus file descriptor in a file-related system call.<ul>
<li>Since Process A passed the file descriptor (fd for short) to OS as parameter, OS can check whether that particular entry is valid (or even exists) in the PCB of A.</li>
<li>If the fd is out of range, non-existent etc, OS can reject the file-related system calls made by Process A.</li>
</ul>
</li>
<li>Process A can never "accidentally" access files opened by Process B.<ul>
<li>Since the fd index is in process specific PCB, there is no way Process A can access Process B's file descriptor table.</li>
</ul>
</li>
<li>Process A and Process B reads from the same file. However, their reading should not affect each other.<ul>
<li>Process A and Process B can have their own fds, which refers to two distinct locations in the open file table.</li>
<li>Each entry of the open file table keep track of the current location separately. This enables Process A and Process B to read from the same file independently.</li>
</ul>
</li>
<li>Redirect Process A's standard input / output, e.g. "a.out &lt; test.in &gt; test.out".<ul>
<li>So, for all file redirections, it is a simple question of:<ul>
<li>Opening and possibly creating the file.</li>
<li>Replace the corresponding file descriptor to point to the entry from (1) in the open file table.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="directory">Directory</h3>
<ul>
<li>Used to<ul>
<li>Provide a logical grouping of files</li>
<li>Keep track of files</li>
</ul>
</li>
<li>Single-Level<ul>
<li>All files are in root directory</li>
</ul>
</li>
<li>Tree-Structured<ul>
<li>Directories can be recursively embedded in other directories</li>
</ul>
</li>
<li>Direct Acyclic Graph<ul>
<li>If a file can be shared, only one copy of actual content</li>
<li>"Appears" in multiple directories with different file names</li>
<li>Alias is for files only, not directories</li>
<li>Unix hard link (<code>ln</code>)<ul>
<li>Directory A and B have separate pointers to the actual file F in disk</li>
</ul>
</li>
<li>Can only be deleted when all links are deleted</li>
</ul>
</li>
<li>General Graph<ul>
<li>Users have the capability to create a cycle of directory within a directory</li>
<li>Hard to traverse, and need to prevent infinite looping</li>
<li>Unix symbolic link/ soft link (<code>ln -s</code>)<ul>
<li>Symbolic link is a special link file that contains the path name of the file F</li>
<li>When link file is accessed, it finds where the F is and accesses F</li>
<li>Simple deletion: link is deleted, not file; file is deleted, dangling link</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="file-system-implementations">File System Implementations</h3>
<ul>
<li><img alt="genericDiskOrganization" src="../genericDiskOrganization.png" /></li>
<li>Master Boot Record (MBR) at sector 0 with partition table</li>
<li>Followed by one or more partitions<ul>
<li>Each partition can contain an independent file system</li>
</ul>
</li>
</ul>
<h4 id="file-block-allocation">File Block Allocation</h4>
<ul>
<li>Contiguous<ul>
<li>Allocate consecutive disk blocks to a file</li>
<li>External fragmentation</li>
</ul>
</li>
<li>Linked list<ul>
<li>Keep a linked list of disk blocks that each stores next disk block number and actual file data</li>
<li>Random access in a file is slow</li>
</ul>
</li>
<li>File allocation table (FAT)<ul>
<li><img alt="FatAllocation" src="../FatAllocation.png" /></li>
<li>FAT entry contains either:<ul>
<li>FREE code (block is unused)</li>
<li>Block number of next block</li>
<li>EOF code (i.e., NULL pointer)</li>
<li>BAD block (block is unusable, i.e., disk error)</li>
</ul>
</li>
<li>Faster random access</li>
<li>FAT keeps track of all disk blocks in a partition, which will be expensive when disk is large</li>
</ul>
</li>
<li>Indexed allocation<ul>
<li>Maintain blocks for each file; IndexBlock[N] == Nth block address</li>
<li>Lesser memory overhead</li>
<li>Limited maximum file size (max number of blocks == number of index block entries)</li>
</ul>
</li>
<li>I-Node Data<ul>
<li>Every file/ directory has an I-node associated</li>
<li>Allows fast access to small file</li>
<li>Flexibility in handling huge files</li>
<li><img alt="iNodeDataBlock" src="../iNodeDataBlock.png" /></li>
</ul>
</li>
</ul>
<h4 id="free-space-management">Free Space Management</h4>
<ul>
<li>Maintain free space information</li>
<li>Bitmap<ul>
<li>Each disk block represented by 1 bit</li>
</ul>
</li>
<li>Linked list<ul>
<li>Each disk block contains number of free disk block numbers or pointer to next free space</li>
<li>Easy to locate free block</li>
<li>High overhead</li>
</ul>
</li>
</ul>
<h4 id="implementing-directory">Implementing Directory</h4>
<ul>
<li>Keep track of files in directory</li>
<li>Map the file name to file information</li>
<li>Linear list<ul>
<li>Each directory consists of a linear list where each entry represents a file</li>
<li>Locating a file requires linear search</li>
</ul>
</li>
<li>Hash table<ul>
<li>Each directory consists of a hash table of size N</li>
<li>Fast lookup</li>
<li>Hash table has limited size</li>
</ul>
</li>
<li>File information<ul>
<li>Each directory consists of file information (name and disk block information)</li>
<li>Stored in directory entry directly OR</li>
<li>Store only name and point to some data structure for other info</li>
</ul>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/jquery-3.6.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
